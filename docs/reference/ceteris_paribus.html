<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Ceteris Paribus Profiles aka Individual Variable Profiles — ceteris_paribus • ingredients</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../dalexverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../dalexverse-2.css" rel="stylesheet">
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Ceteris Paribus Profiles aka Individual Variable Profiles — ceteris_paribus" />

<meta property="og:description" content="This explainer works for individual observations.
For each observation it calculates Ceteris Paribus Profiles for selected variables.
Such profiles can be used to hypothesize about model results if selected variable is changed.
For this reason it is also called 'What-If Profiles'." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- google analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-5650686-14""></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-5650686-14');
</script>
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
      <a class = "navbar-mi2logo" href="http://DrWhy.AI/">
    <img src = "https://github.com/ModelOriented/DrWhyTemplate/blob/master/inst/pkgdown/assets/drwhy_znak_violet_small.jpg?raw=true" alt = "MI2" height = 46 title = "MI2">
	  </a>
        <a class="navbar-brand" href="../index.html">ingredients</a>
        <div class="info">
          <span class="partof">part of the <a href="https://github.com/ModelOriented/DrWhy">DrWhy.AI</a>
           developed by the <a href="https://mi2.mini.pw.edu.pl/">MI^2 DataLab</a> </span>
          <span class="version version-default">0.3.8</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Describing-Explanations.html">Describing-Explanations</a>
    </li>
    <li>
      <a href="../articles/vignette_aspect_importance.html">Vignette for aspect importance</a>
    </li>
    <li>
      <a href="../articles/vignette_titanic.html">Survival on the RMS Titanic</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Ceteris Paribus Profiles aka Individual Variable Profiles</h1>
    
    <div class="hidden name"><code>ceteris_paribus.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This explainer works for individual observations.
For each observation it calculates Ceteris Paribus Profiles for selected variables.
Such profiles can be used to hypothesize about model results if selected variable is changed.
For this reason it is also called 'What-If Profiles'.</p>
    
    </div>

    <pre class="usage"><span class='fu'>ceteris_paribus</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for explainer</span>
<span class='fu'>ceteris_paribus</span>(<span class='no'>x</span>, <span class='no'>new_observation</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>variables</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>variable_splits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>grid_points</span> <span class='kw'>=</span> <span class='fl'>101</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>ceteris_paribus</span>(<span class='no'>x</span>, <span class='no'>data</span>, <span class='kw'>predict_function</span> <span class='kw'>=</span> <span class='no'>predict</span>,
  <span class='no'>new_observation</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>variables</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>variable_splits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>grid_points</span> <span class='kw'>=</span> <span class='fl'>101</span>, <span class='kw'>label</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/class'>class</a></span>(<span class='no'>x</span>)[<span class='fl'>1</span>],
  <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a model to be explained, or an explainer created with the `DALEX::explain()` function.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other parameters</p></td>
    </tr>
    <tr>
      <th>new_observation</th>
      <td><p>a new observation with columns that corresponds to variables used in the model</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>true labels for `new_observation`. If specified then will be added to ceteris paribus plots.</p></td>
    </tr>
    <tr>
      <th>variables</th>
      <td><p>names of variables for which profiles shall be calculated. Will be passed to `calculate_variable_splits()`. If NULL then all variables from the validation data will be used.</p></td>
    </tr>
    <tr>
      <th>variable_splits</th>
      <td><p>named list of splits for variables, in most cases created with `calculate_variable_splits()`. If NULL then it will be calculated based on validation data available in the `explainer`.</p></td>
    </tr>
    <tr>
      <th>grid_points</th>
      <td><p>number of points for profile. Will be passed to `calculate_variable_splits()`.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>validation dataset. It will be extracted from `x` if it's an explainer</p></td>
    </tr>
    <tr>
      <th>predict_function</th>
      <td><p>predict function. It will be extracted from `x` if it's an explainer</p></td>
    </tr>
    <tr>
      <th>label</th>
      <td><p>name of the model. By default it's extracted from the 'class' attribute of the model</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of the class 'ceteris_paribus_explainer'.
It's a data frame with calculated average responses.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Find more details in <a href='https://pbiecek.github.io/PM_VEE/ceterisParibus.html'>Ceteris Paribus Chapter</a>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Predictive Models: Visual Exploration, Explanation and Debugging <a href='https://pbiecek.github.io/PM_VEE'>https://pbiecek.github.io/PM_VEE</a></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='st'>"DALEX"</span>)
<span class='co'># Toy examples, because CRAN angels ask for them</span>
<span class='no'>titanic</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/na.fail'>na.omit</a></span>(<span class='no'>titanic</span>)
<span class='no'>model_titanic_glm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></span>(<span class='no'>survived</span> <span class='kw'>==</span> <span class='st'>"yes"</span> ~ <span class='no'>gender</span> + <span class='no'>age</span> + <span class='no'>fare</span>,
                       <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>titanic</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>)

<span class='no'>explain_titanic_glm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/DALEX/topics/explain'>explain</a></span>(<span class='no'>model_titanic_glm</span>,
                           <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>titanic</span>[,-<span class='fl'>9</span>],
                           <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>titanic</span>$<span class='no'>survived</span> <span class='kw'>==</span> <span class='st'>"yes"</span>)</div><div class='output co'>#&gt; Preparation of a new explainer is initiated
#&gt;   -&gt; model label       :  lm  (<span style='color: #BBBB00;'>default</span><span>)
#&gt;   -&gt; data              :  2099  rows  8  cols 
#&gt;   -&gt; target variable   :  2099  values 
#&gt;   -&gt; predict function  :  yhat.glm  will be used (</span><span style='color: #BBBB00;'>default</span><span>)
#&gt;   -&gt; predicted values  :  numerical, min =  0.1483104 , mean =  0.3244402 , max =  0.9822194  
#&gt;   -&gt; residual function :  difference between y and yhat (</span><span style='color: #BBBB00;'>default</span><span>)
#&gt;   -&gt; residuals         :  numerical, min =  -0.8840083 , mean =  1.110794e-14 , max =  0.8437859  
#&gt; </span><span style='color: #00BB00;'>A new explainer has been created!</span><span></div><div class='input'><span class='no'>cp_rf</span> <span class='kw'>&lt;-</span> <span class='fu'>ceteris_paribus</span>(<span class='no'>explain_titanic_glm</span>, <span class='no'>titanic</span>[<span class='fl'>1</span>,])
<span class='no'>cp_rf</span></div><div class='output co'>#&gt; Top profiles    : 
#&gt;       gender        age class    embarked       country fare sibsp parch
#&gt; 1       male 42.0000000   3rd Southampton United States 7.11     0     0
#&gt; 1.1   female 42.0000000   3rd Southampton United States 7.11     0     0
#&gt; 11      male  0.1666667   3rd Southampton United States 7.11     0     0
#&gt; 1.110   male  2.0000000   3rd Southampton United States 7.11     0     0
#&gt; 1.2     male  4.0000000   3rd Southampton United States 7.11     0     0
#&gt; 1.3     male  7.0000000   3rd Southampton United States 7.11     0     0
#&gt;          _yhat_ _vname_ _ids_ _label_
#&gt; 1     0.1857672  gender     1      lm
#&gt; 1.1   0.6711517  gender     1      lm
#&gt; 11    0.2452313     age     1      lm
#&gt; 1.110 0.2423748     age     1      lm
#&gt; 1.2   0.2392846     age     1      lm
#&gt; 1.3   0.2347001     age     1      lm
#&gt; 
#&gt; 
#&gt; Top observations:
#&gt;   gender age class    embarked       country fare sibsp parch    _yhat_ _label_
#&gt; 1   male  42   3rd Southampton United States 7.11     0     0 0.1857672      lm
#&gt;   _ids_
#&gt; 1     1</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>cp_rf</span>, <span class='kw'>variables</span> <span class='kw'>=</span> <span class='st'>"age"</span>)</div><div class='img'><img src='ceteris_paribus-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></span><div class='input'> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='st'>"randomForest"</span>)
 <span class='no'>model_titanic_rf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/randomForest/topics/randomForest'>randomForest</a></span>(<span class='no'>survived</span> ~ <span class='no'>gender</span> + <span class='no'>age</span> + <span class='no'>class</span> + <span class='no'>embarked</span> +
                                    <span class='no'>fare</span> + <span class='no'>sibsp</span> + <span class='no'>parch</span>,  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>titanic</span>)
 <span class='no'>model_titanic_rf</span></div><div class='output co'>#&gt; 
#&gt; Call:
#&gt;  randomForest(formula = survived ~ gender + age + class + embarked +      fare + sibsp + parch, data = titanic) 
#&gt;                Type of random forest: classification
#&gt;                      Number of trees: 500
#&gt; No. of variables tried at each split: 2
#&gt; 
#&gt;         OOB estimate of  error rate: 19.1%
#&gt; Confusion matrix:
#&gt;       no yes class.error
#&gt; no  1321  97  0.06840621
#&gt; yes  304 377  0.44640235</div><div class='input'>
 <span class='no'>explain_titanic_rf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/DALEX/topics/explain'>explain</a></span>(<span class='no'>model_titanic_rf</span>,
                           <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>titanic</span>[,-<span class='fl'>9</span>],
                           <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>titanic</span>$<span class='no'>survived</span>,
                           <span class='kw'>label</span> <span class='kw'>=</span> <span class='st'>"Random Forest v7"</span>)</div><div class='output co'>#&gt; Preparation of a new explainer is initiated
#&gt;   -&gt; model label       :  Random Forest v7 
#&gt;   -&gt; data              :  2099  rows  8  cols 
#&gt;   -&gt; target variable   :  2099  values 
#&gt;   -&gt; target variable   :  Please note that 'y' is a factor.  (<span style='color: #BB0000;'>WARNING</span><span>)
#&gt;   -&gt; target variable   :  Consider changing the 'y' to a logical or numerical vector.
#&gt;   -&gt; target variable   :  Otherwise I will not be able to calculate residuals or loss function.
#&gt;   -&gt; predict function  :  yhat.randomForest  will be used (</span><span style='color: #BBBB00;'>default</span><span>)
#&gt;   -&gt; predicted values  :  numerical, min =  0 , mean =  0.2366394 , max =  1  
#&gt;   -&gt; residual function :  difference between y and yhat (</span><span style='color: #BBBB00;'>default</span><span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: '-' nie ma sensu dla czynników</span></div><div class='output co'>#&gt;   -&gt; residuals         :  numerical, min =  NA , mean =  NA , max =  NA  
#&gt; </span><span style='color: #00BB00;'>A new explainer has been created!</span><span></div><div class='input'>
<span class='co'># select few passangers</span>
<span class='no'>selected_passangers</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='select_sample.html'>select_sample</a></span>(<span class='no'>titanic</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>20</span>)
<span class='no'>cp_rf</span> <span class='kw'>&lt;-</span> <span class='fu'>ceteris_paribus</span>(<span class='no'>explain_titanic_rf</span>, <span class='no'>selected_passangers</span>)
<span class='no'>cp_rf</span></div><div class='output co'>#&gt; Top profiles    : 
#&gt;        gender age            class    embarked country    fare sibsp parch
#&gt; 557      male  50              2nd Southampton England 13.0000     0     0
#&gt; 557.1  female  50              2nd Southampton England 13.0000     0     0
#&gt; 660      male  25              3rd   Cherbourg Lebanon 14.0901     1     0
#&gt; 660.1  female  25              3rd   Cherbourg Lebanon 14.0901     1     0
#&gt; 1535     male  20 restaurant staff Southampton England  0.0000     0     0
#&gt; 1535.1 female  20 restaurant staff Southampton England  0.0000     0     0
#&gt;        _yhat_ _vname_ _ids_          _label_
#&gt; 557     0.004  gender   557 Random Forest v7
#&gt; 557.1   0.922  gender   557 Random Forest v7
#&gt; 660     0.048  gender   660 Random Forest v7
#&gt; 660.1   0.528  gender   660 Random Forest v7
#&gt; 1535    0.000  gender  1535 Random Forest v7
#&gt; 1535.1  0.824  gender  1535 Random Forest v7
#&gt; 
#&gt; 
#&gt; Top observations:
#&gt;      gender age            class    embarked       country    fare sibsp parch
#&gt; 557    male  50              2nd Southampton       England 13.0000     0     0
#&gt; 660    male  25              3rd   Cherbourg       Lebanon 14.0901     1     0
#&gt; 1535   male  20 restaurant staff Southampton       England  0.0000     0     0
#&gt; 942  female  59              2nd Southampton United States 26.0000     0     1
#&gt; 491    male  30              2nd Southampton       England 13.0000     0     0
#&gt; 1639   male  47 victualling crew Southampton       England  0.0000     0     0
#&gt;      _yhat_          _label_ _ids_
#&gt; 557   0.004 Random Forest v7     1
#&gt; 660   0.048 Random Forest v7     2
#&gt; 1535  0.000 Random Forest v7     3
#&gt; 942   0.926 Random Forest v7     4
#&gt; 491   0.004 Random Forest v7     5
#&gt; 1639  0.002 Random Forest v7     6</div><div class='input'>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>cp_rf</span>, <span class='kw'>variables</span> <span class='kw'>=</span> <span class='st'>"age"</span>) +
  <span class='fu'><a href='show_observations.html'>show_observations</a></span>(<span class='no'>cp_rf</span>, <span class='kw'>variables</span> <span class='kw'>=</span> <span class='st'>"age"</span>) +
  <span class='fu'><a href='show_rugs.html'>show_rugs</a></span>(<span class='no'>cp_rf</span>, <span class='kw'>variables</span> <span class='kw'>=</span> <span class='st'>"age"</span>, <span class='kw'>color</span> <span class='kw'>=</span> <span class='st'>"red"</span>)</div><div class='img'><img src='ceteris_paribus-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="author">
  <p>
    Developed by Przemyslaw Biecek, Hubert Baniecki.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>
      </footer>
   </div>

  

  </body>
</html>


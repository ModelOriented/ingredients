<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot Feature Importance Objects in D3 with r2d3 Package. — plotD3.feature_importance_explainer • ingredients</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- dalexverse -->
<link href="../dalexverse.css" rel="stylesheet">
<link href="../dalexverse-2.css" rel="stylesheet">

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>






<meta property="og:title" content="Plot Feature Importance Objects in D3 with r2d3 Package. — plotD3.feature_importance_explainer" />
<meta property="og:description" content="Function plotD3.feature_importance_explainer plots dropouts for variables used in the model.
It uses output from feature_importance function that corresponds to permutation based measure of feature importance.
Variables are sorted in the same order in all panels. The order depends on the average drop out loss.
In different panels variable contributions may not look like sorted if variable importance is different in different models." />
<meta property="og:image" content="/logo.png" />

<meta name="robots" content="noindex" />


<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- google analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-5650686-14""></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-5650686-14');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">ingredients</a>
        <div class="info">
          <span class="partof">part of the <a href="https://github.com/ModelOriented/DrWhy">DrWhy.AI</a>
           developed by the <a href="https://mi2.mini.pw.edu.pl/">MI^2 DataLab</a> </span>
          <span class="version version-default">2.0.1</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignette_describe.html">Explanations in natural language</a>
    </li>
    <li>
      <a href="../articles/vignette_simulated.html">Simulated data, real problem</a>
    </li>
    <li>
      <a href="../articles/vignette_titanic.html">General introduction: Survival on the RMS Titanic</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/ModelOriented/ingredients/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot Feature Importance Objects in D3 with r2d3 Package.</h1>
    <small class="dont-index">Source: <a href='https://github.com/ModelOriented/ingredients/blob/master/R/plotD3_feature_importance.R'><code>R/plotD3_feature_importance.R</code></a></small>
    <div class="hidden name"><code>plotD3_feature_importance.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function <code>plotD3.feature_importance_explainer</code> plots dropouts for variables used in the model.
It uses output from <code><a href='feature_importance.html'>feature_importance</a></code> function that corresponds to permutation based measure of feature importance.
Variables are sorted in the same order in all panels. The order depends on the average drop out loss.
In different panels variable contributions may not look like sorted if variable importance is different in different models.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for feature_importance_explainer</span>
<span class='fu'><a href='plotD3.html'>plotD3</a></span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>...</span>,
  max_vars <span class='op'>=</span> <span class='cn'>NULL</span>,
  show_boxplots <span class='op'>=</span> <span class='cn'>TRUE</span>,
  bar_width <span class='op'>=</span> <span class='fl'>12</span>,
  split <span class='op'>=</span> <span class='st'>"model"</span>,
  scale_height <span class='op'>=</span> <span class='cn'>FALSE</span>,
  margin <span class='op'>=</span> <span class='fl'>0.15</span>,
  chart_title <span class='op'>=</span> <span class='st'>"Feature importance"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a feature importance explainer produced with the <code><a href='feature_importance.html'>feature_importance()</a></code> function</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other explainers that shall be plotted together</p></td>
    </tr>
    <tr>
      <th>max_vars</th>
      <td><p>maximum number of variables that shall be presented for for each model.
By default <code>NULL</code> which means all variables</p></td>
    </tr>
    <tr>
      <th>show_boxplots</th>
      <td><p>logical if <code>TRUE</code> (default) boxplot will be plotted to show permutation data.</p></td>
    </tr>
    <tr>
      <th>bar_width</th>
      <td><p>width of bars in px. By default <code>12px</code></p></td>
    </tr>
    <tr>
      <th>split</th>
      <td><p>either "model" or "feature" determines the plot layout</p></td>
    </tr>
    <tr>
      <th>scale_height</th>
      <td><p>a logical. If <code>TRUE</code>, the height of plot scales with window size. By default it's <code>FALSE</code></p></td>
    </tr>
    <tr>
      <th>margin</th>
      <td><p>extend x axis domain range to adjust the plot.
Usually value between <code>0.1</code> and <code>0.3</code>, by default it's <code>0.15</code></p></td>
    </tr>
    <tr>
      <th>chart_title</th>
      <td><p>a character. Set custom title</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>r2d3</code> object.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Explanatory Model Analysis. Explore, Explain, and Examine Predictive Models. <a href='https://pbiecek.github.io/ema/'>https://pbiecek.github.io/ema/</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://dalex.drwhy.ai'>"DALEX"</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://ModelOriented.github.io/ingredients/'>"ingredients"</a></span><span class='op'>)</span>

<span class='va'>lm_model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>m2.price</span> <span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>apartments</span><span class='op'>)</span>
<span class='va'>explainer_lm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dalex.drwhy.ai/reference/explain.html'>explain</a></span><span class='op'>(</span><span class='va'>lm_model</span>,
                        data <span class='op'>=</span> <span class='va'>apartments</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>,
                        y <span class='op'>=</span> <span class='va'>apartments</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>,
                        verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>fi_lm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='feature_importance.html'>feature_importance</a></span><span class='op'>(</span><span class='va'>explainer_lm</span>,
      loss_function <span class='op'>=</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='va'><a href='https://dalex.drwhy.ai/reference/loss_functions.html'>loss_root_mean_square</a></span>, B <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>fi_lm</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            variable mean_dropout_loss label
#&gt; 1      _full_model_          279.3262    lm
#&gt; 2 construction.year          279.2987    lm
#&gt; 3          no.rooms          289.6181    lm
#&gt; 4             floor          503.1583    lm
#&gt; 5           surface          620.3488    lm
#&gt; 6          district          990.7506    lm</div><div class='input'><span class='fu'><a href='plotD3.html'>plotD3</a></span><span class='op'>(</span><span class='va'>fi_lm</span><span class='op'>)</span>

<span class='co'># \donttest{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/imbs-hl/ranger'>"ranger"</a></span><span class='op'>)</span>

<span class='va'>rf_model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ranger/man/ranger.html'>ranger</a></span><span class='op'>(</span><span class='va'>m2.price</span><span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>apartments</span><span class='op'>)</span>

<span class='va'>explainer_rf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dalex.drwhy.ai/reference/explain.html'>explain</a></span><span class='op'>(</span><span class='va'>rf_model</span>,
                        data <span class='op'>=</span> <span class='va'>apartments</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>,
                        y <span class='op'>=</span> <span class='va'>apartments</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>,
                        label <span class='op'>=</span> <span class='st'>"ranger forest"</span>,
                        verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>fi_rf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='feature_importance.html'>feature_importance</a></span><span class='op'>(</span><span class='va'>explainer_rf</span>, loss_function <span class='op'>=</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='va'><a href='https://dalex.drwhy.ai/reference/loss_functions.html'>loss_root_mean_square</a></span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>fi_rf</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            variable mean_dropout_loss         label
#&gt; 1      _full_model_          144.1809 ranger forest
#&gt; 2          no.rooms          300.9969 ranger forest
#&gt; 3 construction.year          378.9817 ranger forest
#&gt; 4             floor          426.2261 ranger forest
#&gt; 5           surface          521.2871 ranger forest
#&gt; 6          district          774.9314 ranger forest</div><div class='input'><span class='fu'><a href='plotD3.html'>plotD3</a></span><span class='op'>(</span><span class='va'>fi_lm</span>, <span class='va'>fi_rf</span><span class='op'>)</span>

<span class='fu'><a href='plotD3.html'>plotD3</a></span><span class='op'>(</span><span class='va'>fi_lm</span>, <span class='va'>fi_rf</span>, split <span class='op'>=</span> <span class='st'>"feature"</span><span class='op'>)</span>

<span class='fu'><a href='plotD3.html'>plotD3</a></span><span class='op'>(</span><span class='va'>fi_lm</span>, <span class='va'>fi_rf</span>, max_vars <span class='op'>=</span> <span class='fl'>3</span>, bar_width <span class='op'>=</span> <span class='fl'>16</span>, scale_height <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='plotD3.html'>plotD3</a></span><span class='op'>(</span><span class='va'>fi_lm</span>, <span class='va'>fi_rf</span>, max_vars <span class='op'>=</span> <span class='fl'>3</span>, bar_width <span class='op'>=</span> <span class='fl'>16</span>, split <span class='op'>=</span> <span class='st'>"feature"</span>, scale_height <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='plotD3.html'>plotD3</a></span><span class='op'>(</span><span class='va'>fi_lm</span>, margin <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span>
<span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Przemyslaw Biecek, Hubert Baniecki.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Ceteris Paribus Profiles aka Individual Variable Profiles — ceteris_paribus • ingredients</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- dalexverse -->
<link href="../dalexverse.css" rel="stylesheet">
<link href="../dalexverse-2.css" rel="stylesheet">

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>






<meta property="og:title" content="Ceteris Paribus Profiles aka Individual Variable Profiles — ceteris_paribus" />
<meta property="og:description" content="This explainer works for individual observations.
For each observation it calculates Ceteris Paribus Profiles for selected variables.
Such profiles can be used to hypothesize about model results if selected variable is changed.
For this reason it is also called 'What-If Profiles'." />
<meta property="og:image" content="/logo.png" />

<meta name="robots" content="noindex" />


<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- google analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-5650686-14""></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-5650686-14');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">ingredients</a>
        <div class="info">
          <span class="partof">part of the <a href="https://github.com/ModelOriented/DrWhy">DrWhy.AI</a>
           developed by the <a href="https://mi2.mini.pw.edu.pl/">MI^2 DataLab</a> </span>
          <span class="version version-default">1.3.1</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignette_describe.html">Explanations in natural language</a>
    </li>
    <li>
      <a href="../articles/vignette_simulated.html">Simulated data, real problem</a>
    </li>
    <li>
      <a href="../articles/vignette_titanic.html">General introduction: Survival on the RMS Titanic</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/ModelOriented/ingredients/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Ceteris Paribus Profiles aka Individual Variable Profiles</h1>
    <small class="dont-index">Source: <a href='https://github.com/ModelOriented/ingredients/blob/master/R/ceteris_paribus.R'><code>R/ceteris_paribus.R</code></a></small>
    <div class="hidden name"><code>ceteris_paribus.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This explainer works for individual observations.
For each observation it calculates Ceteris Paribus Profiles for selected variables.
Such profiles can be used to hypothesize about model results if selected variable is changed.
For this reason it is also called 'What-If Profiles'.</p>
    </div>

    <pre class="usage"><span class='fu'>ceteris_paribus</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for explainer</span>
<span class='fu'>ceteris_paribus</span>(
  <span class='no'>x</span>,
  <span class='no'>new_observation</span>,
  <span class='kw'>y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>variables</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>variable_splits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>grid_points</span> <span class='kw'>=</span> <span class='fl'>101</span>,
  <span class='kw'>variable_splits_type</span> <span class='kw'>=</span> <span class='st'>"quantiles"</span>,
  <span class='no'>...</span>
)

<span class='co'># S3 method for default</span>
<span class='fu'>ceteris_paribus</span>(
  <span class='no'>x</span>,
  <span class='no'>data</span>,
  <span class='kw'>predict_function</span> <span class='kw'>=</span> <span class='no'>predict</span>,
  <span class='no'>new_observation</span>,
  <span class='kw'>y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>variables</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>variable_splits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>grid_points</span> <span class='kw'>=</span> <span class='fl'>101</span>,
  <span class='kw'>variable_splits_type</span> <span class='kw'>=</span> <span class='st'>"quantiles"</span>,
  <span class='kw'>label</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span>(<span class='no'>x</span>)[<span class='fl'>1</span>],
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>an explainer created with the <code><a href='https://rdrr.io/pkg/DALEX/man/explain.html'>DALEX::explain()</a></code> function, or a model to be explained.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other parameters</p></td>
    </tr>
    <tr>
      <th>new_observation</th>
      <td><p>a new observation with columns that corresponds to variables used in the model</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>true labels for <code>new_observation</code>. If specified then will be added to ceteris paribus plots.
NOTE: It is best when target variable is not present in the <code>new_observation</code></p></td>
    </tr>
    <tr>
      <th>variables</th>
      <td><p>names of variables for which profiles shall be calculated.
Will be passed to <code><a href='calculate_variable_split.html'>calculate_variable_split</a></code>.
If NULL then all variables from the validation data will be used.</p></td>
    </tr>
    <tr>
      <th>variable_splits</th>
      <td><p>named list of splits for variables, in most cases created with <code><a href='calculate_variable_split.html'>calculate_variable_split</a></code>.
If NULL then it will be calculated based on validation data available in the <code>explainer</code>.</p></td>
    </tr>
    <tr>
      <th>grid_points</th>
      <td><p>maximum number of points for profile calculations. Note that the finaln number of points may be lower than <code>grid_points</code>, eg. if there is not enough unique values for a given variable. Will be passed to <code><a href='calculate_variable_split.html'>calculate_variable_split</a></code>.</p></td>
    </tr>
    <tr>
      <th>variable_splits_type</th>
      <td><p>how variable grids shall be calculated? Use "quantiles" (default) for percentiles or "uniform" to get uniform grid of points</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>validation dataset. It will be extracted from <code>x</code> if it's an explainer
NOTE: It is best when target variable is not present in the <code>data</code></p></td>
    </tr>
    <tr>
      <th>predict_function</th>
      <td><p>predict function. It will be extracted from <code>x</code> if it's an explainer</p></td>
    </tr>
    <tr>
      <th>label</th>
      <td><p>name of the model. By default it's extracted from the <code>class</code> attribute of the model</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of the class <code>ceteris_paribus_explainer</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Find more details in <a href='https://pbiecek.github.io/ema/ceterisParibus.html'>Ceteris Paribus Chapter</a>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Explanatory Model Analysis. Explore, Explain and Examine Predictive Models. <a href='https://pbiecek.github.io/ema'>https://pbiecek.github.io/ema</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='st'>"DALEX"</span>)
<span class='co'># smaller data, quicker example</span>
<span class='no'>titanic_small</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='select_sample.html'>select_sample</a></span>(<span class='no'>titanic_imputed</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>1313</span>)

<span class='co'># build a model</span>
<span class='no'>model_titanic_glm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span>(<span class='no'>survived</span> ~ <span class='no'>gender</span> + <span class='no'>age</span> + <span class='no'>fare</span>,
                         <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>titanic_small</span>,
                         <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>)

<span class='no'>explain_titanic_glm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DALEX/man/explain.html'>explain</a></span>(<span class='no'>model_titanic_glm</span>,
                               <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>titanic_small</span>[,-<span class='fl'>8</span>],
                               <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>titanic_small</span>[,<span class='fl'>8</span>],
                               <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='no'>cp_rf</span> <span class='kw'>&lt;-</span> <span class='fu'>ceteris_paribus</span>(<span class='no'>explain_titanic_glm</span>, <span class='no'>titanic_small</span>[<span class='fl'>1</span>,])
<span class='no'>cp_rf</span></div><div class='output co'>#&gt; Top profiles    : 
#&gt;         gender   age class    embarked fare sibsp parch    _yhat_ _vname_ _ids_
#&gt; 515     female 45.00   2nd Southampton 10.1     0     0 0.5595687  gender   515
#&gt; 515.1     male 45.00   2nd Southampton 10.1     0     0 0.1448038  gender   515
#&gt; 5151      male  0.75   2nd Southampton 10.1     0     0 0.3135247     age   515
#&gt; 515.110   male  2.99   2nd Southampton 10.1     0     0 0.3028164     age   515
#&gt; 515.2     male  4.98   2nd Southampton 10.1     0     0 0.2934793     age   515
#&gt; 515.3     male  7.00   2nd Southampton 10.1     0     0 0.2841757     age   515
#&gt;         _label_
#&gt; 515          lm
#&gt; 515.1        lm
#&gt; 5151         lm
#&gt; 515.110      lm
#&gt; 515.2        lm
#&gt; 515.3        lm
#&gt; 
#&gt; 
#&gt; Top observations:
#&gt;     gender age class    embarked fare sibsp parch    _yhat_ _label_ _ids_
#&gt; 515   male  45   2nd Southampton 10.1     0     0 0.1448038      lm     1</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>cp_rf</span>, <span class='kw'>variables</span> <span class='kw'>=</span> <span class='st'>"age"</span>)</div><div class='img'><img src='ceteris_paribus-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='st'>"randomForest"</span>)
<span class='no'>model_titanic_rf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/randomForest/man/randomForest.html'>randomForest</a></span>(<span class='no'>survived</span> ~<span class='no'>.</span>,  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>titanic_imputed</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: The response has five or fewer unique values.  Are you sure you want to do regression?</span></div><div class='input'>

<span class='no'>explain_titanic_rf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/DALEX/man/explain.html'>explain</a></span>(<span class='no'>model_titanic_rf</span>,
                              <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>titanic_imputed</span>[,-<span class='fl'>8</span>],
                              <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>titanic_imputed</span>[,<span class='fl'>8</span>],
                              <span class='kw'>label</span> <span class='kw'>=</span> <span class='st'>"Random Forest v7"</span>,
                              <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># select few passangers</span>
<span class='no'>selected_passangers</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='select_sample.html'>select_sample</a></span>(<span class='no'>titanic_imputed</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>20</span>)
<span class='no'>cp_rf</span> <span class='kw'>&lt;-</span> <span class='fu'>ceteris_paribus</span>(<span class='no'>explain_titanic_rf</span>, <span class='no'>selected_passangers</span>)
<span class='no'>cp_rf</span></div><div class='output co'>#&gt; Top profiles    : 
#&gt;        gender age            class    embarked    fare sibsp parch     _yhat_
#&gt; 515    female  45              2nd Southampton 10.1000     0     0 0.85053814
#&gt; 515.1    male  45              2nd Southampton 10.1000     0     0 0.09490975
#&gt; 604    female  17              3rd Southampton  7.1701     1     0 0.47411576
#&gt; 604.1    male  17              3rd Southampton  7.1701     1     0 0.11321362
#&gt; 1430   female  25 engineering crew Southampton  0.0000     0     0 0.69052740
#&gt; 1430.1   male  25 engineering crew Southampton  0.0000     0     0 0.24005121
#&gt;        _vname_ _ids_          _label_
#&gt; 515     gender   515 Random Forest v7
#&gt; 515.1   gender   515 Random Forest v7
#&gt; 604     gender   604 Random Forest v7
#&gt; 604.1   gender   604 Random Forest v7
#&gt; 1430    gender  1430 Random Forest v7
#&gt; 1430.1  gender  1430 Random Forest v7
#&gt; 
#&gt; 
#&gt; Top observations:
#&gt;      gender age            class    embarked    fare sibsp parch     _yhat_
#&gt; 515    male  45              2nd Southampton 10.1000     0     0 0.09490975
#&gt; 604    male  17              3rd Southampton  7.1701     1     0 0.11321362
#&gt; 1430   male  25 engineering crew Southampton  0.0000     0     0 0.24005121
#&gt; 865    male  20              3rd   Cherbourg  7.0406     0     0 0.11517589
#&gt; 452  female  17              3rd  Queenstown  7.1408     0     0 0.64019375
#&gt; 1534   male  38 victualling crew Southampton  0.0000     0     0 0.15301516
#&gt;               _label_ _ids_
#&gt; 515  Random Forest v7     1
#&gt; 604  Random Forest v7     2
#&gt; 1430 Random Forest v7     3
#&gt; 865  Random Forest v7     4
#&gt; 452  Random Forest v7     5
#&gt; 1534 Random Forest v7     6</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>cp_rf</span>, <span class='kw'>variables</span> <span class='kw'>=</span> <span class='st'>"age"</span>) +
  <span class='fu'><a href='show_observations.html'>show_observations</a></span>(<span class='no'>cp_rf</span>, <span class='kw'>variables</span> <span class='kw'>=</span> <span class='st'>"age"</span>) +
  <span class='fu'><a href='show_rugs.html'>show_rugs</a></span>(<span class='no'>cp_rf</span>, <span class='kw'>variables</span> <span class='kw'>=</span> <span class='st'>"age"</span>, <span class='kw'>color</span> <span class='kw'>=</span> <span class='st'>"red"</span>)</div><div class='img'><img src='ceteris_paribus-2.png' alt='' width='700' height='433' /></div><div class='input'>
# }

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Przemyslaw Biecek, Hubert Baniecki, Adam Izdebski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


